<!-- 
Hello 
<script>

    function getQueryParam(key) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(key);
    }

    const nameKey = 'name';
    const existingValue = localStorage.getItem(nameKey);

    if (existingValue) {
      // Check if div already exists
      if (!document.getElementById('nameDisplay')) {
        const div = document.createElement('div');
        div.id = 'site-navigation';
        div.textContent = `${nameKey}: ${existingValue}`;
        document.body.appendChild(div);
      }
    } else {
      const nameFromUrl = getQueryParam(nameKey);
      // if (nameFromUrl) {
        localStorage.setItem(nameKey, window.location.ancestorOrigins[0]);
        
      // }
    }

</script>
 -->
 <!DOCTYPE html>
<html>
<head><title>Iframe Page</title></head>
<body>
<script>
  // Open IndexedDB
  function openDB() {
    return new Promise((resolve, reject) => {
      const req = indexedDB.open("MyDatabase", 1);
      req.onupgradeneeded = (e) => {
        const db = e.target.result;
        db.createObjectStore("users", { keyPath: "id" });
      };
      req.onsuccess = () => resolve(req.result);
      req.onerror = () => reject(req.error);
    });
  }

  window.addEventListener("message", async (e) => {
    const db = await openDB();

    if (e.data.action === "getUser") {
      const tx = db.transaction("users", "readonly");
      const store = tx.objectStore("users");
      const req = store.get(e.data.id);
        debugger
      req.onsuccess = () => {
        e.source.postMessage({ user: req.result }, e.origin);
      };
    }

    if (e.data.action === "addUser") {
      const tx = db.transaction("users", "readwrite");
      const store = tx.objectStore("users");
      store.put(e.data.user);
      tx.oncomplete = () => {
        e.source.postMessage({ status: "added" }, e.origin);
      };
    }
  });
</script>
</body>
</html>
